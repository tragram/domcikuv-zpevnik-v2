import{r as w,R,j as b,d as T,v as W}from"./main-CPNzXsvC.js";var $=Object.defineProperty,v=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,y=(e,t,r)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t)=>{for(var r in t||(t={}))O.call(t,r)&&y(e,r,t[r]);if(v)for(var r of v(t))_.call(t,r)&&y(e,r,t[r]);return e},M=(e,t)=>{var r={};for(var a in e)O.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&v)for(var a of v(e))t.indexOf(a)<0&&_.call(e,a)&&(r[a]=e[a]);return r};function B(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}var k=({fontSizePx:e,minFontSizePx:t,fontSizePrecisionPx:r,updateFontSizePx:a,breakPredicate:n})=>{const i=Math.ceil(1/r);let o=0;for(;e>t&&o<i&&!n();)e=a(e-r),o++},h=e=>{const t=getComputedStyle(e);return e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)},m=e=>{const t=getComputedStyle(e);return e.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)},N=e=>{e.innerEl.style.whiteSpace="nowrap",I(e),e.innerEl.scrollWidth>h(e.containerEl)&&(e.innerEl.style.whiteSpace="normal")},I=({innerEl:e,containerEl:t,fontSizePx:r,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i,updateFontSizePx:o})=>{let u=0,l=1;for(;u<10;){const d=e.scrollWidth,s=h(t),p=r<n&&d<s,f=r>a&&d>s,g=d/s;if(l===g||!(p||f))break;const j=r/g-r,A=r;if(r=o(r+j),Math.abs(r-A)<=i)break;l=g,u++}k({fontSizePx:r,minFontSizePx:a,updateFontSizePx:o,fontSizePrecisionPx:i,breakPredicate:()=>e.scrollWidth<=h(t)})},C=({innerEl:e,containerEl:t,fontSizePx:r,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i,updateFontSizePx:o})=>{r=o((n-a)*.5);let u=(n-a)*.25,l=0;for(;u>i&&l<100;){const d=e.scrollWidth,s=h(t),p=e.scrollHeight,f=m(t);if(d===s&&p===f)break;r<n&&d<=s&&p<=f?r=o(r+u):r>a&&(d>s||p>f)&&(r=o(r-u)),u*=.5,l++}k({fontSizePx:r,minFontSizePx:a,updateFontSizePx:o,fontSizePrecisionPx:i,breakPredicate:()=>e.scrollWidth<=h(t)&&e.scrollHeight<=m(t)})};function x({innerEl:e,containerEl:t,mode:r="multiline",minFontSizePx:a=8,maxFontSizePx:n=160,fontSizePrecisionPx:i=.1}){if(performance.now(),!isFinite(a))throw new Error(`Invalid minFontSizePx (${a})`);if(!isFinite(a))throw new Error(`Invalid maxFontSizePx (${n})`);if(!isFinite(i)||i===0)throw new Error(`Invalid fontSizePrecisionPx (${i})`);t.children.length>1&&console.warn(`AutoTextSize has ${t.children.length-1} siblings. This may interfere with the algorithm.`);const o={display:"flex",alignItems:"start"},c={display:"block"};r==="oneline"?c.whiteSpace="nowrap":r==="multiline"?c.wordBreak="break-word":r==="box"?(c.whiteSpace="pre-wrap",c.wordBreak="break-word"):r==="boxoneline"&&(c.whiteSpace="nowrap"),Object.assign(t.style,o),Object.assign(e.style,c);const u=window.getComputedStyle(e,null).getPropertyValue("font-size");let l=parseFloat(u);const d=p=>(p=Math.min(Math.max(p,a),n),l=p,e.style.fontSize=`${l}px`,l);(l>n||l<a)&&d(l);const s={innerEl:e,containerEl:t,fontSizePx:l,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i,updateFontSizePx:d};r==="oneline"?I(s):r==="multiline"?N(s):(r==="box"||r==="boxoneline")&&C(s)}function D({innerEl:e,containerEl:t,mode:r,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i}){let o;const c=B(()=>{x({innerEl:e,containerEl:t,mode:r,maxFontSizePx:n,minFontSizePx:a,fontSizePrecisionPx:i}),o=[h(t),m(t)]}),u=new ResizeObserver(()=>{const l=o;o=[h(t),m(t)],((l==null?void 0:l[0])!==o[0]||(l==null?void 0:l[1])!==o[1])&&c()});return u.observe(t),c.disconnect=()=>u.disconnect(),c}function F(e){var t=e,{mode:r,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i,as:o="div",children:c}=t,u=M(t,["mode","minFontSizePx","maxFontSizePx","fontSizePrecisionPx","as","children"]);const l=w.useRef();w.useEffect(()=>{var s;return(s=l.current)==null?void 0:s.call(l)},[c]);const d=w.useCallback(s=>{var p;(p=l.current)==null||p.disconnect();const f=s==null?void 0:s.parentElement;!s||!f||(l.current=D({innerEl:s,containerEl:f,mode:r,minFontSizePx:a,maxFontSizePx:n,fontSizePrecisionPx:i}))},[r,a,n,i]);return R.createElement(o,H({ref:d},u),c)}function q({song:e,show:t,className:r}){const[a,n]=w.useState(null);return w.useEffect(()=>{t&&!a&&(async()=>{const o=await W(e.id);n(o[0].response)})()},[t]),b.jsx("div",{className:T("px-4 flex flex-grow my-4 w-full ",r),children:b.jsx(F,{mode:"boxoneline",children:b.jsx("p",{className:"text-wrap w-full text-shadow",children:a})})})}export{q as I};
//# sourceMappingURL=IllustrationPrompt-Dtk-iS88.js.map
